---
description: >
  Cleanup CircleCI tunnel and remove IP policy rules

parameters:
  ngrok-api-token:
    type: env_var_name
    description: "Environment variable name containing the Ngrok API token"
    default: NGROK_API_TOKEN
  debug:
    type: boolean
    description: "Enable debug mode"
    default: false

steps:
  - run:
      environment:
        PARAM_NGROK_API_TOKEN: << parameters.ngrok-api-token >>
        DEBUG: << parameters.debug >>
      name: Cleanup tunnel
      command: <<include(scripts/cleanup.sh)>>
